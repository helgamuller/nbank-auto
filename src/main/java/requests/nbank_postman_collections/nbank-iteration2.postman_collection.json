{
	"info": {
		"_postman_id": "912282eb-520c-48c8-895a-51d39ff29757",
		"name": "nbank-iteration2",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "9097655"
	},
	"item": [
		{
			"name": "Deposit money by user",
			"item": [
				{
					"name": "Positive: Authorized user can deposit money on their existing account",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": 2,\n  \"balance\": 300\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"deposit"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can NOT deposit money on their unexisting account",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": 5,\n  \"balance\": 300\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"deposit"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can NOT deposit zero amount",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": 2,\n  \"balance\": 0.0\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"deposit"
							]
						}
					},
					"response": []
				},
				{
					"name": "Contract: Authorized user can NOT deposit string amount",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": 5,\n  \"balance\": \"300\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"deposit"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can NOT deposit negative amount of money on their account",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": 2,\n  \"balance\": -500\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"deposit"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Unauthorized user can NOT deposit money on their existed account",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"id\": 2,\n  \"balance\": 300\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/deposit",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"deposit"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Service operations",
			"item": [
				{
					"name": "Positive: Authorized user can create an account",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts"
							]
						}
					},
					"response": []
				},
				{
					"name": "Admin can successfully create a user",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "admin",
									"type": "string"
								},
								{
									"key": "username",
									"value": "admin",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"username\": \"olga19981\",\n  \"password\": \"olgaO$19981\",\n  \"role\": \"USER\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/admin/users",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"admin",
								"users"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Unauthorized user can NOT create an account",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "User can change name",
			"item": [
				{
					"name": "Negative: Authorized user can change their name to an empty one",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/customer/profile",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"customer",
								"profile"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can change their name to null",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": null\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/customer/profile",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"customer",
								"profile"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can change their name to 300 symbols length",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"f3xL8mJqZ5B7kdUp9wE2ThRAOyc1nF0sgXvPQltu6zKe4YMiHbGvNJrCMXoqaS9bDfLUeR7mhnKW3PgAxOYVcBZJQ1N8tyFiLgx6UsMvo2Ecp5wdRTaH7zkqmCnXE9f4LuTbYGHpjrUo02VZMb\"\n\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/customer/profile",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"customer",
								"profile"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Unauthorized user can NOT change their name",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "",
									"type": "string"
								},
								{
									"key": "username",
									"value": "",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": 100\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/customer/profile",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"customer",
								"profile"
							]
						}
					},
					"response": []
				},
				{
					"name": "Positive: Authorized user can change their name to a valid one",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "PUT",
						"header": [
							{
								"key": "Authorization",
								"value": "Basic b2xnYTE5OTgxOm9sZ2FPJDE5OTgx",
								"type": "text",
								"disabled": true
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"Olga1\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/customer/profile",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"customer",
								"profile"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Money transfers between accounts",
			"item": [
				{
					"name": "Positive: Authorized user can transfer money between existing accounts where transferred amount < source account's balance",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderAccountId\": 1,\n  \"receiverAccountId\": 2,\n  \"amount\": 50\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/transfer",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"transfer"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can NOT transfer money if transferred amount > source account balance",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderAccountId\": 4,\n  \"receiverAccountId\": 1,\n  \"amount\": 50000\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/transfer",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"transfer"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can NOT transfer negative amount of money",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderAccountId\": 5,\n  \"receiverAccountId\": 1,\n  \"amount\": -50\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/transfer",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"transfer"
							]
						}
					},
					"response": []
				},
				{
					"name": "Positive: Authorized user can transfer money if transferred amount = source account balance",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderAccountId\": 4,\n  \"receiverAccountId\": 1,\n  \"amount\": 50000\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/transfer",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"transfer"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can NOT transfer money from an existing account to non-existing one",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderAccountId\": 1,\n  \"receiverAccountId\": 2,\n  \"amount\": 50\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/transfer",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"transfer"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Authorized user can NOT transfer money from a non-existing account to existing one",
					"request": {
						"auth": {
							"type": "basic",
							"basic": [
								{
									"key": "password",
									"value": "olgaO$19981",
									"type": "string"
								},
								{
									"key": "username",
									"value": "olga19981",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderAccountId\": 10,\n  \"receiverAccountId\": 2,\n  \"amount\": 50\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/transfer",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"transfer"
							]
						}
					},
					"response": []
				},
				{
					"name": "Negative: Unauthorized user can NOT transfer money between their accouns",
					"request": {
						"auth": {
							"type": "noauth"
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"senderAccountId\": 1,\n  \"receiverAccountId\": 2,\n  \"amount\": 50\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{base_url}}/api/v1/accounts/transfer",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"api",
								"v1",
								"accounts",
								"transfer"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					"// Генерация username: olga + случайные цифры, длина 6–12 символов",
					"const randomSuffix = Math.random().toString(36).replace(/[^a-z0-9]/g, '').slice(0, 8);",
					"const username = `olga_${randomSuffix}`.slice(0, 15);",
					"",
					"// Генерация сложного пароля (8+ символов, с условиями)",
					"function generateStrongPassword() {",
					"    const lower = 'abcdefghijklmnopqrstuvwxyz';",
					"    const upper = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';",
					"    const digits = '0123456789';",
					"    const specials = '!@#$%^&*()_+-=[]{}|;:,.<>?';",
					"",
					"    const getRandom = (str) => str[Math.floor(Math.random() * str.length)];",
					"",
					"    let password = getRandom(lower) + getRandom(upper) + getRandom(digits) + getRandom(specials);",
					"",
					"    // добиваем до нужной длины",
					"    const all = lower + upper + digits + specials;",
					"    while (password.length < 10) {",
					"        password += getRandom(all);",
					"    }",
					"",
					"    return password;",
					"}",
					"",
					"// Случайная роль",
					"const roles = ['USER', 'ADMIN'];",
					"const role = roles[Math.floor(Math.random() * roles.length)];",
					"",
					"// Сохраняем в переменные",
					"pm.environment.set(\"username\", username);",
					"pm.environment.set(\"password\", generateStrongPassword());",
					"pm.environment.set(\"role\", role);"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	]
}